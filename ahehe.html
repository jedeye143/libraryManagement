<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Library Management System</title>
    <!-- Tailwind CSS CDN -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.5/font/bootstrap-icons.min.css">
    <style>
        .book-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .book-cover {
            height: 240px;
            background-size: cover;
            background-position: center;
            position: relative;
            border-radius: 2px 8px 8px 2px;
            box-shadow: 
                5px 5px 20px rgba(0,0,0,0.2),
                1px 1px 5px rgba(0,0,0,0.1);
        }
      
.book-spine {
    /* Remove rotation and transformations */
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 20px;
    background: linear-gradient(to right, rgba(0,0,0,0.1), rgba(0,0,0,0.05) 5px, rgba(255,255,255,0.15) 8px, rgba(0,0,0,0.05) 12px);
    border-radius: 2px 0 0 2px;
}

.book-info {
    background: white;
    border-radius: 0 0 8px 8px;
    padding: 1rem;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.status-badge {
    position: absolute;
    top: 10px;
    right: 10px;
    z-index: 1;
}

.modal {
    /* Remove any animation in the modal */
    opacity: 1;
}

.sidebar {
    height: calc(100vh - 80px);
}

@media (max-width: 768px) {
    .sidebar {
        height: auto;
    }
}

.main-content-wrapper {
    height: calc(100vh - 80px); /* Subtract header height */
    display: flex;
    flex-direction: column;
}

.books-scroll-area {
    flex: 1;
    overflow-y: auto;
    padding: 1rem;
}

.fixed-content {
    padding: 1rem;
}
.book-card {
    @apply relative transform transition-all duration-300;
}

.book-inner {
    position: relative;
    transform-style: preserve-3d;
    transition: all 0.3s ease;
}

.book-card:hover .book-inner {
    transform: translateY(-8px) rotateZ(-3deg);
}

/* Add shadow effect for depth */
.book-card:hover .book-inner::after {
    content: '';
    position: absolute;
    bottom: -15px;
    left: 10%;
    width: 80%;
    height: 20px;
    background: rgba(0,0,0,0.1);
    filter: blur(10px);
    border-radius: 50%;
}


/* Update the books container gap */
.books-scroll-area .grid {
    gap: 8px;
}

/* Remove the book preview animation */
.book-preview-container {
    perspective: none;
    opacity: 1;
    transform: none;
    transition: none;
}

.book-preview-container.open .book-left-page,
.book-preview-container.open .book-right-page {
    transform: none;
    box-shadow: none;
}

.book-right-page {
    transform: none;
}

.prose p {
    margin-bottom: 1.5em;
}

/* Custom scrollbar for summary */
.prose::-webkit-scrollbar {
    width: 8px;
}

.prose::-webkit-scrollbar-track {
    background: #f1f1f1;
    border-radius: 4px;
}

.prose::-webkit-scrollbar-thumb {
    background: #db2777;
    border-radius: 4px;
}

.prose::-webkit-scrollbar-thumb:hover {
    background: #be185d;
}

    </style>
</head>
<body class="bg-pink-50 min-h-screen">

    <!-- Header -->
    <header class="bg-gradient-to-r from-pink-600 to-pink-800 text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex justify-between items-center">
                <div class="flex items-center">
                    <i class="bi bi-book text-3xl mr-3"></i>
                    <h1 class="text-3xl font-bold">Library Management System</h1>
                </div>
                <div class="md:hidden">
                    <button id="mobile-menu-btn" class="text-white">
                        <i class="bi bi-list text-2xl"></i>
                    </button>
                </div>
                <button id="add-book-btn" class="hidden md:flex bg-white text-pink-800 px-4 py-2 rounded-lg shadow hover:bg-pink-100 items-center">
                    <i class="bi bi-plus-circle mr-2"></i>
                    Add New Book
                </button>
            </div>
        </div>
    </header>

    <div class="flex flex-col md:flex-row">
        <!-- Sidebar -->
        <aside id="sidebar" class="sidebar bg-white w-full md:w-64 shadow-md md:block hidden">
            <div class="p-6">
                <div class="flex items-center justify-center mb-8">
                    <div class="w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center">
                        <i class="bi bi-person text-pink-600 text-xl"></i>
                    </div>
                    <div class="ml-3">
                        <p class="font-medium">Admin User</p>
                        <p class="text-xs text-gray-500">Library Manager</p>
                    </div>
                </div>
                
                <nav>
                    <ul>
                        <li class="mb-2">
                            <a href="#" class="flex items-center p-3 rounded-lg bg-pink-50 text-pink-700">
                                <i class="bi bi-grid mr-3"></i>
                                <span>Dashboard</span>
                            </a>
                        </li>
                        <li class="mb-2">
                            <a href="#" class="flex items-center p-3 rounded-lg hover:bg-gray-100">
                                <i class="bi bi-book mr-3"></i>
                                <span>All Books</span>
                            </a>
                        </li>
                        <li class="mb-2">
                            <a href="#" class="flex items-center p-3 rounded-lg hover:bg-gray-100">
                                <i class="bi bi-check-circle mr-3"></i>
                                <span>Available Books</span>
                            </a>
                        </li>
                        <li class="mb-2">
                            <a href="#" class="flex items-center p-3 rounded-lg hover:bg-gray-100">
                                <i class="bi bi-x-circle mr-3"></i>
                                <span>Borrowed Books</span>
                            </a>
                        </li>
                        <li class="mb-2">
                            <a href="#" class="flex items-center p-3 rounded-lg hover:bg-gray-100">
                                <i class="bi bi-people mr-3"></i>
                                <span>Authors</span>
                            </a>
                        </li>
                    </ul>
                </nav>
                
                <div class="mt-12">
                    <button id="sidebar-add-btn" class="w-full bg-pink-600 text-white px-4 py-2 rounded-lg hover:bg-pink-700 flex items-center justify-center">
                        <i class="bi bi-plus-circle mr-2"></i>
                        Add New Book
                    </button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1">
            <div class="main-content-wrapper">
                <!-- Fixed Content Section -->
                <div class="fixed-content">
                    <!-- Mobile Add Button -->
                    <div class="mb-4 md:hidden">
                        <button id="mobile-add-btn" class="w-full bg-pink-600 text-white px-4 py-2 rounded-lg hover:bg-pink-700 flex items-center justify-center">
                            <i class="bi bi-plus-circle mr-2"></i>
                            Add New Book
                        </button>
                    </div>
                    
                    <!-- Stats Section -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                        <div class="bg-white rounded-lg shadow p-4 flex items-center">
                            <div class="rounded-full bg-pink-100 p-3 mr-4">
                                <i class="bi bi-collection text-pink-600 text-xl"></i>
                            </div>
                            <div>
                                <p class="text-gray-500 text-sm">Total Books</p>
                                <h3 id="total-books" class="text-2xl font-bold">0</h3>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-4 flex items-center">
                            <div class="rounded-full bg-green-100 p-3 mr-4">
                                <i class="bi bi-check-circle text-green-600 text-xl"></i>
                            </div>
                            <div>
                                <p class="text-gray-500 text-sm">Available Books</p>
                                <h3 id="available-books" class="text-2xl font-bold">0</h3>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-4 flex items-center">
                            <div class="rounded-full bg-red-100 p-3 mr-4">
                                <i class="bi bi-x-circle text-red-600 text-xl"></i>
                            </div>
                            <div>
                                <p class="text-gray-500 text-sm">Borrowed Books</p>
                                <h3 id="borrowed-books" class="text-2xl font-bold">0</h3>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg shadow p-4 flex items-center">
                            <div class="rounded-full bg-purple-100 p-3 mr-4">
                                <i class="bi bi-people text-purple-600 text-xl"></i>
                            </div>
                            <div>
                                <p class="text-gray-500 text-sm">Authors</p>
                                <h3 id="total-authors" class="text-2xl font-bold">0</h3>
                            </div>
                        </div>
                    </div>

                    <!-- Search & Filter -->
                    <div class="bg-white rounded-lg shadow p-4 mb-6">
                        <div class="flex flex-col md:flex-row gap-4">
                            <div class="flex-grow">
                                <div class="relative">
                                    <input type="text" id="search-input" placeholder="Search books by title, author or ISBN..." 
                                        class="w-full pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500">
                                    <i class="bi bi-search absolute left-3 top-3 text-gray-400"></i>
                                </div>
                            </div>
                            <div>
                                <button id="sort-btn" class="bg-gray-200 hover:bg-gray-300 text-gray-700 px-4 py-2 rounded-lg flex items-center">
                                    <i class="bi bi-sort-alpha-down mr-2"></i>
                                    Sort
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Scrollable Books Section -->
                <div class="books-scroll-area">
                    <div id="books-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 p-4">
                        <!-- Books will be displayed here -->
                    </div>

                    <!-- Empty State -->
                    <div id="empty-state" class="hidden flex flex-col items-center justify-center py-16 text-center">
                        <i class="bi bi-book text-6xl text-gray-300 mb-4"></i>
                        <h3 class="text-xl font-semibold text-gray-500 mb-2">No Books Found</h3>
                        <p class="text-gray-400 max-w-md">There are no books in your library yet or none match your search criteria.</p>
                        <button id="empty-add-btn" class="mt-6 bg-pink-600 text-white px-4 py-2 rounded-lg hover:bg-pink-700">
                            Add Your First Book
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Add/Edit Book Modal -->
    <div id="book-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-lg w-full max-w-md p-6 mx-4">
            <div class="flex justify-between items-center mb-6">
                <h2 id="modal-title" class="text-2xl font-bold">Add New Book</h2>
                <button id="close-modal-btn" class="text-gray-400 hover:text-gray-600">
                    <i class="bi bi-x-lg"></i>
                </button>
            </div>
            <form id="book-form">
                <input type="hidden" id="book-id">
                <div class="mb-4">
                    <label for="title" class="block text-gray-700 font-medium mb-2">Title</label>
                    <input type="text" id="title" name="title" required
                        class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500">
                </div>
                <div class="mb-4">
                    <label for="author" class="block text-gray-700 font-medium mb-2">Author</label>
                    <input type="text" id="author" name="author" required
                        class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500">
                </div>
                <div class="mb-4">
                    <label for="isbn" class="block text-gray-700 font-medium mb-2">ISBN</label>
                    <input type="text" id="isbn" name="isbn" required
                        class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500">
                </div>
                <div class="mb-4">
                    <label for="summary" class="block text-gray-700 font-medium mb-2">Summary</label>
                    <textarea id="summary" name="summary" rows="4" required
                        class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500 resize-none"></textarea>
                </div>
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="published" class="block text-gray-700 font-medium mb-2">Publish Date</label>
                        <input type="text" id="published" name="published" required
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500"
                            placeholder="e.g., 1887">
                    </div>
                    <div>
                        <label for="language" class="block text-gray-700 font-medium mb-2">Language</label>
                        <input type="text" id="language" name="language" required
                            class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500"
                            placeholder="e.g., English">
                    </div>
                </div>
                <div class="mb-4">
                    <label for="cover" class="block text-gray-700 font-medium mb-2">Cover Image</label>
                    <input type="file" id="cover" name="cover" accept="image/*" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500">
                </div>
                <div class="mb-6">
                    <label for="status" class="block text-gray-700 font-medium mb-2">Status</label>
                    <select id="status" name="status" required
                        class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-pink-500">
                        <option value="available">Available</option>
                        <option value="borrowed">Borrowed</option>
                    </select>
                </div>
                <div class="flex justify-end space-x-3">
                    <button type="button" id="cancel-btn" 
                        class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100">
                        Cancel
                    </button>
                    <button type="submit" id="save-btn"
                        class="px-4 py-2 bg-pink-600 text-white rounded-lg hover:bg-pink-700">
                        Save Book
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-lg w-full max-w-md p-6 mx-4">
            <div class="text-center mb-6">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-full bg-red-100 mb-4">
                    <i class="bi bi-exclamation-triangle text-red-500 text-2xl"></i>
                </div>
                <h3 class="text-xl font-bold mb-2">Delete Book</h3>
                <p class="text-gray-500">Are you sure you want to delete this book? This action cannot be undone.</p>
            </div>
            <div class="flex justify-center space-x-3">
                <button id="cancel-delete-btn" 
                    class="px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100">
                    Cancel
                </button>
                <button id="confirm-delete-btn"
                    class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">
                    Delete
                </button>
            </div>
        </div>
    </div>

    <!-- Add this modal for book preview just before the closing body tag -->
    <div id="book-preview-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden z-50">
        <div class="absolute inset-0 flex items-center justify-center p-4">
            <div class="bg-white w-full max-w-5xl rounded-lg shadow-2xl transform transition-all duration-500 book-preview-container">
                <div class="flex h-[700px] relative">
                  
                    <!-- Left Page (Cover) -->
                    <div class="w-1/2 p-8 bg-gray-50 rounded-l-lg border-r border-gray-200 transform origin-right transition-all duration-700 book-left-page relative">
                        <div class="h-full flex flex-col relative">
                            <!-- Book Status Badge -->
                            <div class="absolute top-2 right-2 z-20">
                                <span id="preview-status" class="px-3 py-1 rounded-full text-sm font-medium"></span>
                            </div>
                            
                            <!-- Book Cover Image -->
                            <div class="relative h-3/4 mb-6">
                                <div class="absolute inset-0 rounded-lg shadow-lg overflow-hidden">
                                    <img id="preview-cover" src="" alt="Book Cover" 
                                         class="w-full h-full object-cover transform transition-transform duration-500 hover:scale-105">
                                </div>
                            </div>
                            
                            <!-- Book Title and Author -->
                            <div class="text-center space-y-4">
                                <h2 id="preview-title" class="text-3xl font-bold text-gray-800 leading-tight"></h2>
                                <div class="flex items-center justify-center space-x-2">
                                    <i class="bi bi-person-fill text-pink-600"></i>
                                    <p id="preview-author" class="text-lg text-gray-600"></p>
                                </div>
                                <div class="flex items-center justify-center space-x-2">
                                    <i class="bi bi-upc text-pink-600"></i>
                                    <p id="preview-isbn" class="text-sm text-gray-500"></p>
                                </div>
                            </div>
                        </div>
                    </div>
              <!-- Book Preview Container -->
<div class="flex items-center justify-center p-8">
    <!-- Left Side: Book Cover -->
    
</div>

    <!-- Right Side: Book Details (Summary, Status, Published, Language) -->
    <div class="w-2/3 p-8 bg-white rounded-r-lg">
        <div class="h-full flex flex-col">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-semibold text-gray-800">Book Summary</h3>
                <button id="close-preview-btn" class="p-2 hover:bg-gray-100 rounded-full transition-colors duration-200">
                    <i class="bi bi-x-lg text-gray-500 hover:text-gray-700"></i>
                </button>
            </div>
            
            <div class="prose prose-pink max-w-none flex-grow overflow-y-auto">
                <p id="preview-summary" class="text-gray-600 leading-relaxed text-lg"></p>
            </div>
            
            <!-- Additional Book Details -->
            <div class="mt-6 pt-6 border-t border-gray-200">
                <div class="grid grid-cols-3 gap-4">
                    <div class="text-center p-4 bg-pink-50 rounded-lg">
                        <p class="text-sm text-gray-500 mb-1">Status</p>
                        <p id="preview-status-bottom" class="font-semibold text-gray-800"></p>
                    </div>
                    <div class="text-center p-4 bg-pink-50 rounded-lg">
                        <p class="text-sm text-gray-500 mb-1">Published</p>
                        <p id="preview-published" class="font-semibold text-gray-800"></p>
                    </div>
                    <div class="text-center p-4 bg-pink-50 rounded-lg">
                        <p class="text-sm text-gray-500 mb-1">Language</p>
                        <p id="preview-language" class="font-semibold text-gray-800"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

                </div>
            </div>
        </div>
    </div>

    <script>
        let books = [
        { id: 1, title: "Noli Me Tangere", author: "José Rizal", isbn: "9789711790168", status: "available", cover: "https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/20bbcb87-1202-4b37-888d-54b71cf2e402/d76ptl8-2ecccb85-8e03-4bbe-93ff-2b16da8f63e4.jpg/v1/fill/w_1024,h_1808,q_75,strp/noli_me_tangere_cover_remixed_by_arthuriglesias_d76ptl8-fullview.jpg?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7InBhdGgiOiJcL2ZcLzIwYmJjYjg3LTEyMDItNGIzNy04ODhkLTU0YjcxY2YyZTQwMlwvZDc2cHRsOC0yZWNjY2I4NS04ZTAzLTRiYmUtOTNmZi0yYjE2ZGE4ZjYzZTQuanBnIiwiaGVpZ2h0IjoiPD0xODA4Iiwid2lkdGgiOiI8PTEwMjQifV1dLCJhdWQiOlsidXJuOnNlcnZpY2U6aW1hZ2Uud2F0ZXJtYXJrIl0sIndtayI6eyJwYXRoIjoiXC93bVwvMjBiYmNiODctMTIwMi00YjM3LTg4OGQtNTRiNzFjZjJlNDAyXC9hcnRodXJpZ2xlc2lhcy00LnBuZyIsIm9wYWNpdHkiOjk1LCJwcm9wb3J0aW9ucyI6MC40NSwiZ3Jhdml0eSI6ImNlbnRlciJ9fQ.FTY-TEFz5IG9AXmXXFq4y3Tw88vak8YBjaZRWZ6aHys" },
        { id: 2, title: "El Filibusterismo", author: "José Rizal", isbn: "9789711790175", status: "borrowed", cover: "https://m.media-amazon.com/images/I/711HLGoYJQL._AC_UF1000,1000_QL80_.jpg" },
        { id: 3, title: "Banaag at Sikat", author: "Lope K. Santos", isbn: "9789715425974", status: "available", cover: "https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1275526742i/8366834.jpg" },
        { id: 4, title: "Florante at Laura", author: "Francisco Balagtas", isbn: "9789715690013", status: "available", cover: "https://aliatamiamalayao.wordpress.com/wp-content/uploads/2020/01/82715562_108114497296323_6495374325590261760_n-1.jpg" },
        { id: 5, title: "Dekada '70", author: "Lualhati Bautista", isbn: "9789715422225", status: "borrowed", cover: "https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1541742156i/42734737.jpg" },
        { id: 6, title: "GAPÔ", author: "Lualhati Bautista", isbn: "9789715422232", status: "available", cover: "https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1215489074i/1431556.jpg" },
        { id: 7, title: "America Is in the Heart", author: "Carlos Bulosan", isbn: "9780295952895", status: "available", cover: "https://1882foundation.org/wp-content/uploads/2019/07/america-is-in-the-heart.jpg" },
        { id: 8, title: "The Woman Who Had Two Navels", author: "Nick Joaquin", isbn: "9789715696114", status: "borrowed", cover: "https://upload.wikimedia.org/wikipedia/en/f/f2/The_Woman_Who_Had_Two_Navels_by_Nick_Joaquin_Book_Cover.jpg" },
        { id: 9, title: "Ilustrado", author: "Miguel Syjuco", isbn: "9780374174781", status: "available", cover: "https://images-na.ssl-images-amazon.com/images/S/compressed.photo.goodreads.com/books/1312051293i/6905480.jpg" },
        { id: 10, title: "Smaller and Smaller Circles", author: "F.H. Batacan", isbn: "9781616953980", status: "available", cover: "https://m.media-amazon.com/images/M/MV5BY2VkODYzNGEtMjA0Mi00YzliLWE1ODMtNDgwYjIxYmQxZTY3XkEyXkFqcGc@._V1_.jpg" }
    ];

    // Update your books array with more detailed information
    books = books.map(book => ({
        ...book,
        summary: getBookDetails(book.title).summary,
        published: getBookDetails(book.title).published,
        language: getBookDetails(book.title).language
    }));

    const booksContainer = document.getElementById('books-container');
    const bookModal = document.getElementById('book-modal');
    const deleteModal = document.getElementById('delete-modal');
    const emptyState = document.getElementById('empty-state');
    const bookForm = document.getElementById('book-form');
    const modalTitle = document.getElementById('modal-title');
    const addBookBtn = document.getElementById('add-book-btn');
    const sidebarAddBtn = document.getElementById('sidebar-add-btn');
    const mobileAddBtn = document.getElementById('mobile-add-btn');
    const emptyAddBtn = document.getElementById('empty-add-btn');
    const closeModalBtn = document.getElementById('close-modal-btn');
    const cancelBtn = document.getElementById('cancel-btn');
    const cancelDeleteBtn = document.getElementById('cancel-delete-btn');
    const confirmDeleteBtn = document.getElementById('confirm-delete-btn');
    const searchInput = document.getElementById('search-input');
    const sortBtn = document.getElementById('sort-btn');
    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
    const sidebar = document.getElementById('sidebar');
    
    // Statistics elements
    const totalBooksEl = document.getElementById('total-books');
    const availableBooksEl = document.getElementById('available-books');
    const borrowedBooksEl = document.getElementById('borrowed-books');
    const totalAuthorsEl = document.getElementById('total-authors');
    
    // Form fields
    const bookIdInput = document.getElementById('book-id');
    const titleInput = document.getElementById('title');
    const authorInput = document.getElementById('author');
    const isbnInput = document.getElementById('isbn');
    const statusInput = document.getElementById('status');
    const coverInput = document.getElementById('cover');
    
    // Variable to keep track of delete book id
    let deleteBookId = null;
    let sortDirection = 'asc';
    
    // Initialize the application
    function init() {
        renderBooks();
        updateStats();
        setupEventListeners();
    }
    
    // Render books to the UI
    function renderBooks(booksToRender = books) {
        booksContainer.innerHTML = '';
        
        if (booksToRender.length === 0) {
            emptyState.classList.remove('hidden');
        } else {
            emptyState.classList.add('hidden');
            
            booksToRender.forEach(book => {
                const bookCard = document.createElement('div');
                bookCard.className = 'book-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer';
                
                // Add click handler to the entire card
                bookCard.addEventListener('click', (e) => {
                    // Don't open preview if clicking edit or delete buttons
                    if (!e.target.closest('.edit-btn') && !e.target.closest('.delete-btn')) {
                        openBookPreview(book);
                    }
                });
                
                const statusClass = book.status === 'available' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800';
                const statusText = book.status.charAt(0).toUpperCase() + book.status.slice(1);
                
                bookCard.innerHTML = `
                    <div class="relative group">
                        <!-- Book Container -->
                        <div class="book-inner transform transition-all duration-300 hover:-translate-y-2 hover:rotate-[-3deg]">
                            <!-- Book Spine -->
                            <div class="absolute left-0 top-0 bottom-0 w-6 bg-gradient-to-r from-gray-800 to-gray-700 rounded-l-sm"></div>
                            
                            <!-- Book Cover -->
                            <div class="ml-6 bg-white rounded-r-sm shadow-xl">
                                <!-- Book Cover Image -->
                                <div class="relative h-72 overflow-hidden rounded-tr-sm">
                                    <div class="absolute inset-0 bg-cover bg-center" style="background-image: url('${book.cover}')"></div>
                                    <!-- Status Badge -->
                                    <div class="absolute top-2 right-2">
                                        <span class="px-2 py-1 rounded-full text-xs font-medium ${statusClass}">
                                            ${statusText}
                                        </span>
                                    </div>
                                </div>

                                <!-- Book Info -->
                                <div class="p-4 bg-white border-t border-gray-200">
                                    <h3 class="text-lg font-bold text-gray-800 mb-1 line-clamp-1">${book.title}</h3>
                                    <p class="text-gray-600 text-sm mb-1">
                                        <i class="bi bi-person-fill mr-1"></i> ${book.author}
                                    </p>
                                    <p class="text-gray-500 text-xs mb-4">
                                        <i class="bi bi-upc mr-1"></i> ISBN: ${book.isbn}
                                    </p>
                                    
                                    <!-- Action Buttons -->
                                    <div class="flex space-x-2">
                                        <button data-id="${book.id}" class="edit-btn flex-1 bg-blue-300 hover:bg-blue-400 text-black py-2 rounded flex items-center justify-center transition-colors duration-200">
                                            <i class="bi bi-pencil mr-1"></i> Edit
                                        </button>
                                        <button data-id="${book.id}" class="delete-btn flex-1 bg-red-50 hover:bg-red-100 text-red-600 py-2 rounded flex items-center justify-center transition-colors duration-200">
                                            <i class="bi bi-trash mr-1"></i> Delete
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Book Pages Effect -->
                            <div class="absolute right-0 top-0 bottom-0 w-1 bg-gray-200"></div>
                        </div>
                    </div>
                `;
                
                booksContainer.appendChild(bookCard);
            });
            
            // Add event listeners to edit and delete buttons
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', handleEditClick);
            });
            
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', handleDeleteClick);
            });
        }
    }
    
    // Update statistics
    function updateStats() {
        const totalBooks = books.length;
        const availableBooks = books.filter(book => book.status === 'available').length;
        const borrowedBooks = books.filter(book => book.status === 'borrowed').length;
        
        // Get unique authors
        const uniqueAuthors = new Set(books.map(book => book.author));
        const totalAuthors = uniqueAuthors.size;
        
        totalBooksEl.textContent = totalBooks;
        availableBooksEl.textContent = availableBooks;
        borrowedBooksEl.textContent = borrowedBooks;
        totalAuthorsEl.textContent = totalAuthors;
    }
    
    // Toggle sidebar on mobile
    function toggleSidebar() {
        if (sidebar.classList.contains('hidden')) {
            sidebar.classList.remove('hidden');
        } else {
            sidebar.classList.add('hidden');
        }
    }
    
    // Setup event listeners
    function setupEventListeners() {
        // Mobile menu toggle
        mobileMenuBtn.addEventListener('click', toggleSidebar);
        
        // Open modal for adding a book (multiple buttons)
        addBookBtn.addEventListener('click', () => openModal());
        sidebarAddBtn.addEventListener('click', () => openModal());
        mobileAddBtn.addEventListener('click', () => openModal());
        emptyAddBtn.addEventListener('click', () => openModal());
        
        // Close modal
        closeModalBtn.addEventListener('click', closeModal);
        cancelBtn.addEventListener('click', closeModal);
        
        // Close delete modal
        cancelDeleteBtn.addEventListener('click', closeDeleteModal);
        
        // Handle form submission
        bookForm.addEventListener('submit', handleFormSubmit);
        
        // Handle delete confirmation
        confirmDeleteBtn.addEventListener('click', handleDeleteConfirm);
        
        // Search functionality
        searchInput.addEventListener('input', handleSearch);
        
        // Sort functionality
        sortBtn.addEventListener('click', handleSort);
        
        // Sidebar navigation links (filter by status)
        document.querySelectorAll('nav a').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                
                // Remove active class from all links
                document.querySelectorAll('nav a').forEach(l => {
                    l.classList.remove('bg-pink-50', 'text-pink-700');
                    l.classList.add('hover:bg-gray-100');
                });
                
                // Add active class to clicked link
                link.classList.add('bg-pink-50', 'text-pink-700');
                link.classList.remove('hover:bg-gray-100');
                
                // Get the filter value from the link text
                const text = link.innerText.trim();
                let filteredBooks = books;
                
                if (text === 'Available Books') {
                    filteredBooks = books.filter(book => book.status === 'available');
                } else if (text === 'Borrowed Books') {
                    filteredBooks = books.filter(book => book.status === 'borrowed');
                }
                
                // Render filtered books
                renderBooks(filteredBooks);
                
                // Hide sidebar on mobile after selection
                if (window.innerWidth < 768) {
                    sidebar.classList.add('hidden');
                }
            });
        });

        // Add preview modal close handlers
        closePreviewBtn.addEventListener('click', closeBookPreview);
        previewModal.addEventListener('click', (e) => {
            if (e.target === previewModal) {
                closeBookPreview();
            }
        });
    }
    
    // Open the modal for adding or editing
    function openModal(bookToEdit = null) {
        // Reset the form
        bookForm.reset();
        bookIdInput.value = '';
        
        if (bookToEdit) {
            // Edit mode
            modalTitle.textContent = 'Edit Book';
            bookIdInput.value = bookToEdit.id;
            titleInput.value = bookToEdit.title;
            authorInput.value = bookToEdit.author;
            isbnInput.value = bookToEdit.isbn;
            statusInput.value = bookToEdit.status;
            document.getElementById('summary').value = bookToEdit.summary || '';
            document.getElementById('published').value = bookToEdit.published || '';
            document.getElementById('language').value = bookToEdit.language || '';
            coverInput.value = ''; // Clear file input
        } else {
            // Add mode
            modalTitle.textContent = 'Add New Book';
        }
        
        bookModal.classList.remove('hidden');
    }
    
    // Close the modal
    function closeModal() {
        bookModal.classList.add('hidden');
    }
    
    // Open delete confirmation modal
    function openDeleteModal(id) {
        deleteBookId = id;
        deleteModal.classList.remove('hidden');
    }
    
    // Close delete confirmation modal
    function closeDeleteModal() {
        deleteModal.classList.add('hidden');
        deleteBookId = null;
    }
    
    // Handle form submission (add or edit)
    function handleFormSubmit(e) {
        e.preventDefault();
        
        const bookId = bookIdInput.value;
        const title = titleInput.value.trim();
        const author = authorInput.value.trim();
        const isbn = isbnInput.value.trim();
        const status = statusInput.value;
        const summary = document.getElementById('summary').value.trim();
        const published = document.getElementById('published').value.trim();
        const language = document.getElementById('language').value.trim();
        const coverFile = coverInput.files[0];
        
        // Handle image upload
        let coverUrl = '';
        if (coverFile) {
            coverUrl = URL.createObjectURL(coverFile);
        } else if (bookId) {
            // If editing and no new image is uploaded, keep the existing cover
            const existingBook = books.find(book => book.id == bookId);
            coverUrl = existingBook ? existingBook.cover : '';
        }
        
        if (bookId) {
            // Edit existing book
            const index = books.findIndex(book => book.id == bookId);
            if (index !== -1) {
                books[index] = {
                    id: parseInt(bookId),
                    title,
                    author,
                    isbn,
                    status,
                    cover: coverUrl,
                    summary,
                    published,
                    language
                };
            }
        } else {
            // Add new book
            const newId = books.length > 0 ? Math.max(...books.map(book => book.id)) + 1 : 1;
            const newBook = {
                id: newId,
                title,
                author,
                isbn,
                status,
                cover: coverUrl,
                summary,
                published,
                language
            };
            books.push(newBook);
        }
        
        // Update UI
        renderBooks();
        updateStats();
        closeModal();
    }
    
    // Handle edit button click
    function handleEditClick(e) {
        const bookId = e.currentTarget.dataset.id;
        const bookToEdit = books.find(book => book.id == bookId);
        
        if (bookToEdit) {
            openModal(bookToEdit);
        }
    }
    
    // Handle delete button click
    function handleDeleteClick(e) {
        const bookId = e.currentTarget.dataset.id;
        openDeleteModal(bookId);
    }
    
    // Handle delete confirmation
    function handleDeleteConfirm() {
        if (deleteBookId) {
            books = books.filter(book => book.id != deleteBookId);
            renderBooks();
            updateStats();
            closeDeleteModal();
        }
    }

    // Handle search functionality
    function handleSearch() {
        const query = searchInput.value.trim().toLowerCase();
        const filteredBooks = books.filter(book => 
            book.title.toLowerCase().includes(query) ||
            book.author.toLowerCase().includes(query) ||
            book.isbn.toLowerCase().includes(query)
        );
        renderBooks(filteredBooks);
    }

    // Handle sort functionality
    function handleSort() {
        sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
        const sortedBooks = [...books].sort((a, b) => {
            if (sortDirection === 'asc') {
                return a.title.localeCompare(b.title);
            } else {
                return b.title.localeCompare(a.title);
            }
        });
        renderBooks(sortedBooks);
    }

    function getBookDetails(title) {
    const book = books.find(book => book.title === title); // Find the book object by title

    if (book) {
        return {
            summary: getSummary(title),
            published: getPublishedDate(title),
            language: getLanguage(title),
            cover: book.cover // Add the cover URL to the returned data
        };
    } else {
        return {
            summary: "Summary not available for this book.",
            published: "N/A",
            language: "N/A",
            cover: "N/A"
        };
    }
}

// Example functions for summary, published date, and language (you can add more details here)
function getBookDetails(title) {
    const details = {
        "Noli Me Tangere": {
            summary: `"Noli Me Tangere" (Touch Me Not) is José Rizal's first and most famous novel, published in 1887. This masterpiece of Philippine literature serves as a scathing critique of Spanish colonial rule in the Philippines.

            The story follows Juan Crisóstomo Ibarra, a young Filipino who returns to the Philippines after seven years of study in Europe. He plans to open a modern school and marry his childhood sweetheart, María Clara, but finds himself entangled in the dark realities of Philippine society under Spanish rule.

            Through its rich cast of characters and intricate plot, the novel exposes the corruption of the Spanish colonial authorities and the Catholic church, while exploring themes of love, betrayal, social inequality, and the struggle for reform. The title, derived from the Latin phrase meaning "touch me not," refers to the cancer of society that the novel exposes.

            This groundbreaking work played a crucial role in the development of Filipino nationalism and ultimately contributed to the Philippine Revolution against Spanish colonial rule.`,
            published: "1887",
            language: "Spanish"
        },
        "El Filibusterismo": {
            summary: `"El Filibusterismo" (The Subversive), published in 1891, is the second novel by José Rizal and the sequel to "Noli Me Tangere." The story continues with a darker and more revolutionary tone, reflecting the author's growing disillusionment with the possibility of reform under Spanish rule.

            The novel follows the return of Crisóstomo Ibarra, now transformed into the wealthy jeweler Simoun, who has abandoned his idealistic nature in favor of a ruthless plan for revenge. Under the guise of supporting the Spanish regime, he secretly plots a revolution to overthrow the colonial government.

            Through its complex narrative, the novel explores themes of vengeance, transformation, and the moral costs of revolution. It serves as a profound meditation on the nature of justice, redemption, and the price of freedom.

            The term "filibusterismo" was used by Spanish authorities to condemn those who opposed their rule, marking them as subversives or pirates.`,
            published: "1891",
            language: "Spanish"
        },
    };
    
    return details[title] || {
        summary: "Summary not available for this book.",
        published: "N/A",
        language: "N/A"
    };
}

    // Add preview modal elements
    const previewModal = document.getElementById('book-preview-modal');
    const previewContainer = previewModal.querySelector('.book-preview-container');
    const previewCover = document.getElementById('preview-cover');
    const previewTitle = document.getElementById('preview-title');
    const previewAuthor = document.getElementById('preview-author');
    const previewIsbn = document.getElementById('preview-isbn');
    const previewSummary = document.getElementById('preview-summary');
    const previewPublished = document.getElementById('preview-published');
    const previewLanguage = document.getElementById('preview-language');
    const closePreviewBtn = document.getElementById('close-preview-btn');

    // Update the openBookPreview function
    function openBookPreview(book) {
      
        previewCover.src = book.cover;
        previewTitle.textContent = book.title;
        previewAuthor.textContent = book.author;
        previewIsbn.textContent = `ISBN: ${book.isbn}`;
        previewSummary.textContent = book.summary;
        previewPublished.textContent = book.published;
        previewLanguage.textContent = book.language;

        const statusText = book.status === 'available' ? 'Available' : 'Borrowed';
        const statusClass = book.status === 'available' ? 
            'bg-green-100 text-green-800' : 
            'bg-red-100 text-red-800';

        const statusBadge = document.getElementById('preview-status');
        statusBadge.className = `px-3 py-1 rounded-full text-sm font-medium ${statusClass}`;
        statusBadge.textContent = statusText;

        document.getElementById('preview-status-bottom').textContent = statusText;

        previewModal.classList.remove('hidden');
        requestAnimationFrame(() => {
            previewContainer.classList.add('visible');
            setTimeout(() => {
                previewContainer.classList.add('open');
            }, 100);
        });
    }
    // Update the closeBookPreview function
    function closeBookPreview() {
        previewContainer.classList.remove('open');
        setTimeout(() => {
            previewContainer.classList.remove('visible');
            setTimeout(() => {
                previewModal.classList.add('hidden');
            }, 300);
        }, 500);
    }

    // Add keyboard support for closing the preview
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && !previewModal.classList.contains('hidden')) {
            closeBookPreview();
        }
    });

    // Initialize the app
    init();
    </script>
</body>
</html>